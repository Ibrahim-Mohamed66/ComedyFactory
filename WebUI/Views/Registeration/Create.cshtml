@using Domain.Enums
@using WebUI.Mapper
@using WebUI.ViewModels
@model PersonalDataViewModel

@{
    var isArabic = System.Globalization.CultureInfo.CurrentUICulture.TwoLetterISOLanguageName == "ar";
    var genders = Enum.GetValues(typeof(Gender))
                   .Cast<Gender>()
                   .Select(g => new SelectListItem
                   {
                       Value = g.ToString(),
                       Text = g.Localize(_localizer)
                   })
                   .ToList();
}

<div class="container my-5" dir="@(isArabic ? "rtl" : "ltr")">
    <form asp-controller="Registeration" asp-action="Create">
        @Html.AntiForgeryToken()
        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
        <div class="row">

            <div class="col-md-6">
                <div class="form-group mb-lg-40 mb-20">
                    <label class="form-label ms-3" asp-for="Name">@_localizer["Name"]</label>
                    <input type="text" asp-for="Name" class="form-control" />
                    <small><span asp-validation-for="Name" class="form-text text-danger"></span></small>
                </div>
            </div>

            <div class="col-md-6">
                <div class="form-group mb-lg-40 mb-20">
                    <label class="form-label ms-3" asp-for="Age">@_localizer["Age"]</label>
                    <input type="number" asp-for="Age" class="form-control" min="1" />
                    <small><span asp-validation-for="Age" class="form-text text-danger"></span></small>
                </div>
            </div>



            <div class="col-md-6">
                <div class="form-group mb-lg-40 mb-20">
                    <label class="form-label ms-3" asp-for="Phone">@_localizer["Phone"]</label>
                    <input type="number" asp-for="Phone" class="form-control" />
                    <small><span asp-validation-for="Phone" class="form-text text-danger"></span></small>
                </div>
            </div>

            <div class="col-md-6">
                <div class="form-group mb-lg-40 ms-3">
                    <label class="form-label mb-2" asp-for="Genders">@_localizer["Gender"]</label>
                    <select class="form-select select__field" asp-for="Genders"
                        asp-items="Model.GendersList">
                        <option value="">@_localizer["Select"]</option>
                    </select>
                    <small><span asp-validation-for="Genders" class="form-text text-danger"></span></small>
                </div>
            </div>



            <div class="col-md-6">
                <div class="form-group mb-lg-40 mb-20">
                    <label class="form-label mb-2" asp-for="Email">@_localizer["Email"]</label>
                    <input type="email" asp-for="Email" class="form-control" />
                    <small><span asp-validation-for="Email" class="form-text text-danger"></span></small>
                </div>
            </div>

            <div class="col-md-6">
                <div class="form-group mb-lg-40 mb-20">
                    <label  class="form-label ms-3" asp-for="CountryId">@_localizer["Country"]</label>
                    <select id="countryId" class="form-select select__field" asp-for="CountryId" asp-items="@Model.Countries">
                        <option value="">@_localizer["Select"]</option>
                    </select>
                    <small><span asp-validation-for="CountryId" class="form-text text-danger"></span></small>
                </div>
            </div>


            <div class="col-md-6">
                <div class="form-group mb-lg-40 mb-20">
                    <label class="form-label ms-3"  asp-for="CityId">@_localizer["City"]</label>
                    <select id="cityId" class="form-select select__field" asp-for="CityId" asp-items="@Model.Cities">
                        <option value="">@_localizer["Select"]</option>
                    </select>
                    <small><span asp-validation-for="CityId" class="form-text text-danger"></span></small>
                </div>
            </div>

            <div class="col-md-6">
                <div class="form-group mb-lg-40 mb-20">
                    <label class="form-label ms-3" asp-for="DesireId">@_localizer["IWantToSignUpFor"]</label>
                    <select class="form-select select__field" asp-for="DesireId" asp-items="@Model.Desires">
                        <option value="">@_localizer["Select"]</option>
                    </select>
                    <small><span asp-validation-for="DesireId" class="form-text text-danger"></span></small>
                </div>
            </div>

            <div class="form-group col-12">
                <input id="g-recaptcha-response" name="g-recaptcha-response" type="hidden" value="">
            </div>

            <div class="col-md-6 mb-5">
                <button type="submit" class="btn btn-primary w-100 text-white my-3" id="form_btn">
                    @_localizer["SignUpNow"]
                </button>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
              var citySelect = $('#cityId');
              citySelect.empty();
              
            $('#countryId').on('change', function () {
                var countryId = $(this).val();
                if (countryId != '') {
                    $.ajax({
                        url: '@Url.Action("GetCities", "Registeration")',
                        type: 'GET',
                        data: { countryId: countryId },
                        success: function (data) {
                            citySelect.empty();

                            citySelect.append($('<option>', {
                                value: '',
                                text: '@Html.Raw(_localizer["Select"])'
                            }));
                            $.each(data, function (index, city) {
                                citySelect.append($('<option>', {
                                    value: city.value,
                                    text: city.text
                                }));
                            });
                        },
                        error: function () {
                            alertify.error('Error retrieving cities.');
                        }
                    });
                } else {
                    $('#cityId').empty();
                }
            });
        });
    </script>
    <partial name="_ValidationScriptsPartial" />
}
